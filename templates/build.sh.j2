#!/bin/bash

echo "----------- Test if IP are free for cluster {{m.cluster.id}}"
set +e
# YAB_INCLUDE[snippets/build-ensureip]_BEGIN - Do not modify from this point >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# YAB_INCLUDE[snippets/build-ensureip]_END - You may modify below this <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

set -e

# YAB_INCLUDE[snippets/build-env]_BEGIN - Do not modify from this point >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# YAB_INCLUDE[snippets/build-env]_END - You may modify below this <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<


echo "----------- Will build VM for cluster {{m.cluster.id}}"
# YAB_INCLUDE[snippets/build-createvm]_BEGIN - Do not modify from this point >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# YAB_INCLUDE[snippets/build-createvm]_END - You may modify below this <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

echo "............ Wait for VM creation"
wait



echo "----------- Will build data disks for cluster {{m.cluster.id}}"
# YAB_INCLUDE[snippets/build-ddisks]_BEGIN - Do not modify from this point >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# YAB_INCLUDE[snippets/build-ddisks]_END - You may modify below this <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<



echo "----------- Will start cluster {{m.cluster.id}}"
# YAB_INCLUDE[snippets/build-startvms]_BEGIN - Do not modify from this point >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# YAB_INCLUDE[snippets/build-startvms]_END - You may modify below this <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

echo "............ Wait for VM up and ssh ready"
wait
